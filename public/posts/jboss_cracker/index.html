<!DOCTYPE html>
<html lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8"><meta name="generator" content="Hugo 0.130.0"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Cracking JBoss Passwords&nbsp;&ndash;&nbsp;Nop Sec Consulting Ltd</title><link rel="stylesheet" href="/css/core.min.c793941a2dfbeec1dec89bc471317fe527591cf88c0dc183fb393b86c4d6c14bedb2817d6c5c96c216e5866179a0ed6b.css" integrity="sha384-x5OUGi377sHeyJvEcTF/5SdZHPiMDcGD&#43;zk7hsTWwUvtsoF9bFyWwhblhmF5oO1r"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Cracking JBoss Passwords" /><meta name="twitter:image" content="http://localhost:1313/posts/jboss_cracker//img/jbosslogo.png" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Nop Sec Consulting Ltd</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about/">About</a><a class="nav item" href="/services/">Services</a><a class="nav item" href="https://github%2ecom/nop-sec"target="_blank" rel="noopener noreferrer">GitHub</a></nav></div></span></div><div class="site slogan"><span class="title">Ramblings of a security professional</span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Cracking JBoss Passwords</h1><p class="article date">Saturday, April 4, 2020</p></section><article class="article markdown-body"><h1 id="introduction-to-jboss-eap-67-passwords">Introduction to Jboss EAP 6.7 Passwords</h1>
<p>Not too long ago I came across a Jboss Enterprise Application Platform (EAP) based application server. This is a Java based server used for building, deploying and hosting Java applications and Services. Having gained access to the server using another techniques I was performing some enumeration when I noted the presense of the application.</p>
<p>A bit of research showed me that access to the web portal and command line is controlled by one of two files depending on whether the server is running in a standalone mode or domain.</p>
<pre tabindex="0"><code>EAP_HOME/standalone/configuration/mgmt-users.properties
EAP_HOME/domain/configuration/mgmt-users.properties 
</code></pre><p>New users are created using an included script <em>add-user.sh</em> which takes three inputs. Username, Password and Realm (The Realm can be either ManagementRealm or ApplicationRealm depending on the level of access required). The script then generates a password hash that is added to the relevant properties file in the format of <em>user:hash</em> . Analysis of the script showed that it was taking the three variables and creating an MD5 hash which is definitely not a secure method.</p>
<p><strong>Example:</strong></p>
<ul>
<li>Username: test</li>
<li>Password: password</li>
<li>Realm: ManagementRealm</li>
</ul>
<p>This is formatted as <code>test:ManagementRealm:password</code> and a md5 sum of the resulting string is created as a password hash <code>87c1b764741f1b6d3cac6f95f3a2b226</code></p>
<p>This can be performed in bash using OpenSSL to generate the hash.</p>
<pre tabindex="0"><code>echo -n test:ManagementRealm:password | openssl dgst -md5 -hex
(stdin)= 87c1b764741f1b6d3cac6f95f3a2b226
</code></pre><h1 id="how-can-this-be-abused">How can this be abused?</h1>
<p>Depending on the permissions of the mgmnt-users.properties file there are different attacks you can perform. If badly configured with world writeable privilileges you can just create your own user hash and add it to the properties file. Instant management access to the application.</p>
<p>More likely though is that you will find the file with world readable privileges but not writeable. The percludes adding your own user so you&rsquo;ll need to crack the hashes. As we found out earlier the hash is made up of three components, this unfortunately counts out the use of Hashcat &amp; John.</p>
<p>You can do this in bash using a couple of loops for the user and password dictionarys to create the hash and then compare against the hashes in the properties file. I wanted to create something a bit more long term so put together a small python that takes three inputs the mgmnt-users.properties file, a password dictionary and the realm. It follows the same method of checking for hash collisions to determine valid passwords and will run through the RockYou password list in about 5 minutes per user.</p>
<p><img  src="/img/jboss.png"
        alt="Jboss Cracking"/></p>
<p>A copy of the tool can be found here. <a href="https://github.com/nop-sec/Jboss-EAP-Hash-Cracker"target="_blank" rel="noopener noreferrer">Jboss Password Cracker</a></p>
</article><section class="article labels"><a class="category" href=/categories/tools/>Tools</a><a class="tag" href=/tags/cracking/>Cracking</a><a class="tag" href=/tags/tools/>Tools</a><a class="tag" href=/tags/passwords/>Passwords</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/paintingwithhex/"><span class="iconfont icon-article"></span>Painting With Hex</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">Nop Sec Consulting Ltd</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section>
  

</body>

</html>